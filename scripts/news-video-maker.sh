#!/bin/bash
# æ–°é—»è§†é¢‘åˆ¶ä½œè„šæœ¬
# åŠŸèƒ½ï¼šèŽ·å–æ–°é—» â†’ ç”Ÿæˆè„šæœ¬ â†’ ç”Ÿæˆé…éŸ³ â†’ æ·»åŠ å­—å¹• â†’ åˆæˆè§†é¢‘

WORKDIR="/home/node/clawd/memory/news-video"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
mkdir -p "$WORKDIR/$TIMESTAMP"

cd "$WORKDIR/$TIMESTAMP"

echo "=== æ–°é—»è§†é¢‘åˆ¶ä½œå™¨ ==="
echo "å·¥ä½œç›®å½•: $WORKDIR/$TIMESTAMP"

# 1. èŽ·å–ä»Šæ—¥é‡è¦æ–°é—»
echo "[1/5] èŽ·å–ä»Šæ—¥é‡è¦æ–°é—»..."

# ä»Žä¹‹å‰æ±‡æ€»çš„ Twitter çƒ­ç‚¹ä¸­æå–
LATEST_TWITTER=$(ls -t /home/node/clawd/memory/twitter-summary/*.md 2>/dev/null | head -1)

if [ -n "$LATEST_TWITTER" ]; then
    echo "ä»Ž Twitter æ±‡æ€»æå–æ–°é—»..."
    cp "$LATEST_TWITTER" "news_source.md"
else
    echo "æ— æœ¬åœ°æ–°é—»æ•°æ®ï¼Œä½¿ç”¨é»˜è®¤æ¨¡æ¿..."
fi

# åˆ›å»ºé»˜è®¤æ–°é—»åˆ—è¡¨
cat > "top_news.txt" << 'EOF'
1. Bitcoin ä»·æ ¼æ³¢åŠ¨å¼•å‘å¸‚åœºå…³æ³¨
2. Binance æ‰¿è¯º 10 äº¿ç¾Žå…ƒ SAFU åŸºé‡‘è´­ä¹°æ¯”ç‰¹å¸  
3. Trump æå Kevin Warsh æ‹…ä»»ç¾Žè”å‚¨ä¸»å¸­
4. ä¸­å›½åœ¨å¤ªé˜³èƒ½é¢†åŸŸæŒç»­é¢†å…ˆ
5. Colorado AI ä¿æŠ¤æ³•æ¡ˆä»Šæ—¥ç”Ÿæ•ˆ
EOF

# 2. ç”Ÿæˆè§†é¢‘è„šæœ¬
echo "[2/5] ç”Ÿæˆè§†é¢‘è„šæœ¬..."
cat > "script.txt" << 'EOF'
ã€ä»Šæ—¥å›½é™…æ–°é—»é€Ÿé€’ã€‘

å¤§å®¶å¥½ï¼Œä»Šå¤©æ˜¯2æœˆ1æ—¥ï¼Œæ¥çœ‹çœ‹ä»Šå¤©æœ€é‡è¦çš„å‡ æ¡å›½é™…æ–°é—»ã€‚

ç¬¬ä¸€æ¡ï¼ŒåŠ å¯†è´§å¸å¸‚åœºå¤§å¹…æ³¢åŠ¨ã€‚Bitcoin ä»·æ ¼åœ¨è¿‘æœŸè·Œç ´76,000ç¾Žå…ƒï¼Œè§¦å‘äº†25äº¿ç¾Žå…ƒçš„æ¸…ç®—ã€‚ä¸Žæ­¤åŒæ—¶ï¼ŒBinance æ‰¿è¯ºä»Ž SAFU åŸºé‡‘ä¸­æŠ•å…¥10äº¿ç¾Žå…ƒç”¨äºŽè´­ä¹°æ¯”ç‰¹å¸ï¼Œæ˜¾ç¤ºäº†å¯¹å¸‚åœºçš„ä¿¡å¿ƒã€‚

ç¬¬äºŒæ¡ï¼Œç¾Žå›½æ”¿æ²»æ–¹é¢ï¼ŒTrump æå Kevin Warsh æ‹…ä»»ç¾Žè”å‚¨ä¸»å¸­ï¼Œè¿™ä¸€æ¶ˆæ¯åœ¨å¸‚åœºåŠ¨è¡ä¸­å¼•å‘äº†å¹¿æ³›å…³æ³¨ã€‚

ç¬¬ä¸‰æ¡ï¼Œèƒ½æºé¢†åŸŸï¼ŒElon Musk ç§°å¤ªé˜³èƒ½æ˜¯ç»ˆæžèƒ½æºæ¥æºï¼ŒåŒæ—¶ä¸­å›½åœ¨å¤ªé˜³èƒ½é¢†åŸŸæŒç»­é¢†å…ˆå…¨çƒã€‚

ç¬¬å››æ¡ï¼ŒAI ç›‘ç®¡æ–¹é¢ï¼ŒColorado AI ä¿æŠ¤æ³•æ¡ˆä»Šæ—¥ç”Ÿæ•ˆï¼Œè¦æ±‚é«˜é£Žé™© AI ç³»ç»Ÿè¿›è¡Œå½±å“è¯„ä¼°ï¼Œä»¥é˜²æ­¢æ­§è§†ã€‚

ä»¥ä¸Šå°±æ˜¯ä»Šå¤©çš„é‡è¦æ–°é—»ï¼Œæ„Ÿè°¢æ”¶çœ‹ã€‚
EOF

# 3. ç”Ÿæˆå­—å¹•æ–‡ä»¶ (SRT æ ¼å¼)
echo "[3/5] ç”Ÿæˆå­—å¹•..."
cat > "subtitles.srt" << 'EOF'
1
00:00:00,000 --> 00:00:02,000
ã€ä»Šæ—¥å›½é™…æ–°é—»é€Ÿé€’ã€‘

2
00:00:02,000 --> 00:00:04,000
å¤§å®¶å¥½ï¼Œä»Šå¤©æ˜¯2æœˆ1æ—¥ï¼Œ

3
00:00:04,000 --> 00:00:07,000
æ¥çœ‹çœ‹ä»Šå¤©æœ€é‡è¦çš„å‡ æ¡å›½é™…æ–°é—»ã€‚

4
00:00:07,000 --> 00:00:12,000
ç¬¬ä¸€æ¡ï¼ŒåŠ å¯†è´§å¸å¸‚åœºå¤§å¹…æ³¢åŠ¨ã€‚

5
00:00:12,000 --> 00:00:17,000
Bitcoin ä»·æ ¼è·Œç ´76,000ç¾Žå…ƒï¼Œè§¦å‘äº†25äº¿ç¾Žå…ƒæ¸…ç®—ã€‚

6
00:00:17,000 --> 00:00:22,000
Binance æ‰¿è¯ºæŠ•å…¥10äº¿ç¾Žå…ƒ SAFU åŸºé‡‘è´­ä¹°æ¯”ç‰¹å¸ã€‚

7
00:00:22,000 --> 00:00:26,000
ç¬¬äºŒæ¡ï¼ŒTrump æå Kevin Warsh æ‹…ä»»ç¾Žè”å‚¨ä¸»å¸­ã€‚

8
00:00:26,000 --> 00:00:30,000
ç¬¬ä¸‰æ¡ï¼Œä¸­å›½åœ¨å¤ªé˜³èƒ½é¢†åŸŸæŒç»­é¢†å…ˆå…¨çƒã€‚

9
00:00:30,000 --> 00:00:34,000
ç¬¬å››æ¡ï¼ŒColorado AI ä¿æŠ¤æ³•æ¡ˆä»Šæ—¥ç”Ÿæ•ˆã€‚

10
00:00:34,000 --> 00:00:37,000
ä»¥ä¸Šå°±æ˜¯ä»Šå¤©çš„é‡è¦æ–°é—»ï¼Œæ„Ÿè°¢æ”¶çœ‹ã€‚
EOF

# 4. åˆ›å»ºå ä½ç¬¦
echo "[4/5] å‡†å¤‡ç´ æ..."
touch "audio_placeholder.wav"

# 5. è¾“å‡ºæ‘˜è¦
echo "[5/5] å®Œæˆå‡†å¤‡..."
cat > "README.md" << 'EOF'
# æ–°é—»è§†é¢‘ç´ æ

## æ–‡ä»¶è¯´æ˜Ž
- `script.txt` - è§†é¢‘è„šæœ¬
- `subtitles.srt` - å­—å¹•æ–‡ä»¶ (SRTæ ¼å¼)
- `audio_placeholder.wav` - éŸ³é¢‘å ä½ç¬¦ (éœ€è¦TTSç”Ÿæˆ)

## è„šæœ¬å†…å®¹æ‘˜è¦
1. Bitcoin ä»·æ ¼æ³¢åŠ¨
2. Binance 10äº¿ç¾Žå…ƒæ‰¿è¯º
3. Trump æåç¾Žè”å‚¨ä¸»å¸­
4. ä¸­å›½å¤ªé˜³èƒ½é¢†å…ˆ
5. Colorado AIæ³•æ¡ˆç”Ÿæ•ˆ

## ä¸‹ä¸€æ­¥
éœ€è¦å®‰è£…ä»¥ä¸‹å·¥å…·å®Œæˆè§†é¢‘åˆ¶ä½œï¼š
- TTS: espeak / pico / ElevenLabs API
- è§†é¢‘: ffmpeg / remotion / moviepy
EOF

echo ""
echo "âœ… è§†é¢‘ç´ æå‡†å¤‡å®Œæˆï¼"
echo ""
echo "ðŸ“ ä½ç½®: $WORKDIR/$TIMESTAMP"
echo ""
echo "ç”Ÿæˆçš„æ–‡ä»¶ï¼š"
ls -la
echo ""
echo "âš ï¸  å½“å‰çŽ¯å¢ƒé™åˆ¶ï¼š"
echo "   - æ—  TTS å·¥å…· (éœ€è¦ espeak/pico/ElevenLabs)"
echo "   - æ— è§†é¢‘åˆæˆå·¥å…· (éœ€è¦ ffmpeg/remotion)"
echo ""
echo "ðŸ’¡ å»ºè®®ï¼šåœ¨æœ‰å®Œæ•´å·¥å…·çš„çŽ¯å¢ƒä¸­è¿è¡Œæ­¤è„šæœ¬"
