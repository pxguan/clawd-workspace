# 融合方案：RAG + Markdown 双轨制

## 核心思想

不要让 AI "翻文档"，而是让 AI "查索引"。

```
┌─────────────────────────────────────────────────────┐
│                  用户问题                            │
└──────────────────┬──────────────────────────────────┘
                   │
        ┌──────────┴──────────┐
        │                     │
        ▼                     ▼
┌───────────────┐     ┌─────────────────┐
│  向量检索      │     │  Markdown 浏览   │
│  (AI 准确回答) │     │  (人类可读)      │
└───────┬───────┘     └─────────────────┘
        │
        ▼
┌─────────────────────────────────┐
│  embeddings.json (AI 专用)        │
│  knowledge_base/*.md (人类阅读)   │
└─────────────────────────────────┘
```

## 使用场景

### 场景 1：用户问具体问题
**用户：** "装备管理平台怎么批量导入设备？"

**流程：**
```
问题 → 向量化 → 检索 → Claude 回答
                    ↓
         引用：equipment.md 第 3.2 节
```

### 场景 2：用户想浏览文档
**用户：** "给我看看装备管理平台的目录"

**流程：**
```
读取 knowledge_base/equipment.md → 返回结构化目录
```

## 实现步骤

```bash
# 1. 提取（双轨输出）
python3 scripts/enhanced_extract.py docs/ --output kb/

# 输出：
# kb/chunks.json              # RAG 用
# kb/knowledge_base/index.md  # 人类导航
# kb/knowledge_base/*.md      # 人类阅读

# 2. 创建向量（只对 chunks.json）
python3 scripts/create_embeddings.py kb/chunks.json --output kb/embeddings.json

# 3. 回答问题（RAG 优先）
python3 scripts/answer_question.py kb/ "怎么批量导入？"
```

## 对比析言方案

| 特性 | 他的方案 | 融合方案 |
|------|----------|----------|
| AI 检索 | 关键词匹配 | 向量语义检索 ✅ |
| 人类阅读 | Markdown ✅ | Markdown ✅ |
| 准确率 | 40-60% | 80-90% ✅ |
| 上下文成本 | 高（可能全量扫） | 低（只检索相关） |
| 可维护性 | 中 | 高 ✅ |

## 关键差异

### 他的假设错误
```
"AI 像人类一样，先看目录，再翻页" ❌

实际上：
AI 不擅长多步推理
AI 擅长一次性拿到所有相关内容
```

### 正确做法
```
"AI 向量化问题，一次性找到最相关的 3-5 个片段，然后生成回答" ✅

Markdown 留给人类读，embeddings 留给 AI 用
```

## 何时用他的方案

如果你满足以下条件：
- 文档很小（< 50 页）
- 问题都是关于"结构"（如"有哪些功能模块？"）
- 不需要精准回答细节

否则，**加向量检索**。
